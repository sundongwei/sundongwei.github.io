---
title: 'ğŸ‰ Install and Compile OpenCV'
date: 2024-10-30
permalink: /posts/2012/08/blog-post-1/
tags:
  - Academic
  - Technology
  - AI
---

1. **å®‰è£…**

    â¾¸å…ˆå…ˆå®‰è£…â¼€åˆ‡æœ‰å¿…è¦çš„åŒ…è£¹ï¼š

    ```Shell
    sudo apt-get update
    sudo apt-get upgrade
    sudo apt-get install build-essential cmake
    unzip pkg-config
    sudo apt-get install libjpeg-dev libpng-dev
    libtiff-dev
    sudo apt-get install libavcodec-dev
    libavformat-dev libswscale-dev
    sudo apt-get install libv4l-dev libxvidcore-
    dev libx264-dev
    sudo apt-get install libgtk-3-dev
    sudo apt-get install libatlas-base-dev
    gfortran
    sudo apt-get install python3-dev
    ```

1. **ä¸‹è½½OpenCVæºä»£ç **
æ¥ä¸‹æ¥æˆ‘ä»¬ä¸‹è½½OpenCVçš„æºä»£ç ã€‚è¿™æ˜¯å› ä¸ºå¦‚æœè¦é…ç½®CUDAâ½€æŒï¼ŒOpenCVå¹¶æ²¡æœ‰æä¾›ç°æˆç›´æ¥å®‰è£…çš„åŒ…è£¹ï¼ˆC++ç‰ˆä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä¸åƒPythonçš„èƒ½ç›´æ¥pip installï¼‰ï¼Œæˆ‘ä»¬å¿…é¡»å…ˆä¸‹è½½æºä»£ç ï¼Œç„¶åcmakeç¼–è¯‘åå®‰è£…ã€‚

    2. è¿›â¼ŠOpenCV Github Releaseâ½¹â»šï¼š
[https://github.com/opencv/opencv/releases](https://github.com/opencv/opencv/releases)

    3. é€‰æ‹©ä½ æƒ³è¦çš„ç‰ˆæœ¬ï¼Œæˆ‘é€‰æ‹©äº†æœ€æ–°çš„4.4.0.

    ![image.png](https://s2.loli.net/2024/10/30/3hEybwHjJPsXTIG.png)

        c. æ¥ä¸‹æ¥è½®åˆ°OpenCV-contribï¼š
[https://github.com/opencv/opencv_contrib/releases](https://github.com/opencv/opencv_contrib/releases)

    é€‰æ‹©â¼€æ ·ç‰ˆæœ¬çš„contribï¼ˆä¸â¼€æ ·ç‰ˆæœ¬åæœâ¾ƒè´Ÿå“ˆï¼‰

1. **è§£å‹**

    åœ¨homeä¸‹æ‰“å¼€ç»ˆç«¯ã€‚åŠ ä¸Šä»ä¸Šâ¾¯æ‹¿åˆ°çš„ä¸¤ä¸ªé“¾æ¥ï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤ï¼Œæˆ‘ä»¬èƒ½ä¸‹è½½OpenCVçš„æºä»£ç å¹¶è§£å‹:

    ```Shell
    cd ~
    wget -O opencv.zip
    https://github.com/opencv/opencv/archive/[ä½ çš„ç‰ˆæœ¬å·].zip
    wget -O opencv_contrib.zip
    https://github.com/opencv/opencv_contrib/archive/[ä½ çš„ç‰ˆæœ¬å·].zip
    unzip opencv.zip
    unzip opencv_contrib.zip
    mv opencv-[ä½ çš„ç‰ˆæœ¬å·] opencv
    mv opencv_contrib-[ä½ çš„ç‰ˆæœ¬å·] opencv_contrib
    ```

1. **é€‰æ‹©ç¼–è¯‘**

    ä½¿â½¤cmake-guiï¼Œé€‰æ‹©unix makefiles, ç„¶åæ ¹æ®è§†é¢‘æŠŠä¸éœ€è¦çš„é¡¹â½¬å–æ¶ˆæ‰ï¼Œä¸»è¦æœ‰:opencv_face, opencv_worldï¼Œæ‰€æœ‰testï¼Œopencv_xfeature2d,opencv_stitchingã€‚è®°å¾—æŠŠ**OPENCV_GENERATE_PKGCONFIG** è¿™ä¸ªå‹¾é€‰ä¸Šï¼Œè¦ä¸ç„¶æ²¡æ³•æŸ¥çœ‹Opencvç‰ˆæœ¬ï¼Œè¿˜å¾—â¾ƒâ¼°åˆ›å»ºã€‚

    [https://www.bilibili.com/video/BV1Rp4y1a7cm?spm_id_from=333.999.0.0&vd_source=4fb36de1266349e65e8682fb847af8ee](https://www.bilibili.com/video/BV1Rp4y1a7cm?spm_id_from=333.999.0.0&vd_source=4fb36de1266349e65e8682fb847af8ee)

1. **ç¼–è¯‘**

    ```Shell
    ç¼–è¯‘make -jx,xæ˜¯CPUæ ¸æ•°ï¼Œéšä¾¿å†™â¼€ä¸ªä¹Ÿå¯ä»¥ã€‚ä¾‹å¦‚ï¼š8
    ```

1. **å®‰è£…**

    

    ```Shell
    ç¼–è¯‘æˆåŠŸåæˆ‘ä»¬å°±å¯å®‰è£…ï¼š
    sudo make install
    sudo ldconfig
    ```

1. éªŒè¯

    æ³¨æ„åŠ  4

    ![image 1.png](https://s2.loli.net/2024/10/30/AyIE5Bm7LpOC9bu.png)

    Â· **PKG_CONFIGä½œç”¨**

    ä¸€èˆ¬æˆ‘ä»¬å†™çš„ç¨‹åºéƒ½æ˜¯è¦ä¾èµ–ä¸€äº›åº“ï¼Œä½†åº“çš„å®‰è£…ä½ç½®å¯èƒ½ä¸åŒï¼Œè¿™å°±éœ€è¦ä¸€ä¸ªå·¥å…·èƒ½å¤Ÿç®¡ç†å¹¶èƒ½æœç´¢è¿™äº›åº“çš„è·¯å¾„ï¼ˆå¤´æ–‡ä»¶è·¯å¾„ `/include`ï¼Œåº“æ–‡ä»¶è·¯å¾„ `/lib`ï¼‰ã€‚

    `pkg-config` å°±æ˜¯é€šè¿‡åº“æä¾›çš„ä¸€ä¸ª `.pc` æ–‡ä»¶è·å¾—åº“çš„å„ç§å¿…è¦ä¿¡æ¯çš„ï¼ŒåŒ…æ‹¬ç‰ˆæœ¬ä¿¡æ¯ã€ç¼–è¯‘å’Œè¿æ¥éœ€è¦çš„å‚æ•°ç­‰ã€‚é€šè¿‡ `pkg-config` æä¾›çš„å‚æ•°`â€“cflags, â€“libs`ï¼Œå°†æ‰€éœ€ä¿¡æ¯æå–å‡ºæ¥ä¾›ç¼–è¯‘å’Œè¿æ¥ä½¿ç”¨ã€‚è¿™æ ·ï¼Œä¸ç®¡åº“æ–‡ä»¶å®‰è£…åœ¨å“ªï¼Œé€šè¿‡åº“å¯¹åº”çš„ `.pc` æ–‡ä»¶å°±å¯ä»¥å‡†ç¡®å®šä½ã€‚

    å®ƒæä¾›çš„ä¸»è¦åŠŸèƒ½æœ‰:

    - æ£€æŸ¥åº“çš„ç‰ˆæœ¬å·ã€‚å¦‚æœæ‰€éœ€åº“çš„ç‰ˆæœ¬ä¸æ»¡è¶³è¦æ±‚ï¼Œæ‰“å°å‡ºé”™è¯¯ä¿¡æ¯ï¼Œé¿å…è¿æ¥é”™è¯¯ç‰ˆæœ¬çš„åº“æ–‡ä»¶ï¼›

    - è·å¾—ç¼–è¯‘é¢„å¤„ç†å‚æ•°ï¼Œå¦‚å®å®šä¹‰ï¼Œå¤´æ–‡ä»¶çš„è·¯å¾„ï¼›

    - è·å¾—ç¼–è¯‘å‚æ•°ï¼Œå¦‚åº“åŠå…¶ä¾èµ–çš„å…¶ä»–åº“çš„ä½ç½®ï¼Œæ–‡ä»¶ååŠå…¶ä»–ä¸€äº›è¿æ¥å‚æ•°ï¼›

    - åŠ å…¥æ‰€ä¾èµ–çš„å…¶ä»–åº“çš„è®¾ç½®

    **Â· PKG_CONFIG_PATH**

    `pkg-config` é»˜è®¤ä¼šæœç´¢ `/usr/lib/pkgconfig` å’Œ`/usr/share/pkgconfig`ä¸‹çš„ `.pc` é…ç½®æ–‡ä»¶ï¼Œè‹¥æˆ‘ä»¬æºç ç¼–è¯‘çš„åº“çš„è·¯å¾„ä¸åœ¨ `pkg-config` çš„é»˜è®¤æœç´¢è·¯å¾„ä¸‹ï¼Œåˆ™å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡ `PKG_CONFIG_PATH` å°†è‡ªå®šä¹‰çš„è·¯å¾„æ·»åŠ åˆ° `pkg-config` çš„æœç´¢è·¯å¾„ã€‚

    

    ### æœ€ç»ˆé…ç½®å›¾

    ![image 2.png](https://s2.loli.net/2024/10/30/FWAwzvOrsHK4yhn.png)

    ![image 3.png](https://s2.loli.net/2024/10/30/1tuPkA5HmoeY7zJ.png)

1. **æµ‹è¯•**

    - åˆ›å»ºæ–°â½‚ä»¶å¤¹ï¼Œæˆ‘å‘½åä¸ºOpenCV-Test

    - è¿›â¼Šâ½‚ä»¶å¤¹åå³é”®æ‰“å¼€ç»ˆç«¯

    - touch main.cpp åˆ›å»ºåä¸ºmain.cppçš„â½‚ä»¶

    - å³é”®main.cppï¼Œä½¿â½¤IDEæ‰“å¼€

    - å¤åˆ¶ä»£ç ï¼š

    ```C++
    #include <opencv2/opencv.hpp>
    #include <iostream>
    using namespace cv;
    using namespace std;
    int main(int argc, char** argv)
    {
    //è¯»å–ç…§â½š
     Mat image = imread("OpenCV_Logo.png");
    //æ£€æµ‹å¤±è¯¯
    if (image.empty())
    {
        cout << "Could not open or find the image"<< endl;
        cin.get(); //ç­‰å¾…é”®ç›˜è¾“â¼Š
        return -1;
    }
     String windowName = "OpenCV Test";
    çª—â¼åç§°
    namedWindow(windowName);
    åˆ›å»ºæ–°çª—â¼
    imshow(windowName, image);
    ä½¿â½¤æ–°çª—â¼æ˜¾â½°ç…§â½š
    waitKey(0);
    ç­‰å¾…é”®ç›˜è¾“â¼Š
    destroyWindow(windowName);
    å…³é—­æ‰€æœ‰çª—â¼
    return 0;
    }
    ```
